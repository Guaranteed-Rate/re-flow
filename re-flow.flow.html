<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>re-flow.flow documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Re-flow</span> <span class="project-version">0.7.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>re-flow</span></div></div></li><li class="depth-2 branch"><a href="re-flow.coeffects.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>coeffects</span></div></a></li><li class="depth-2 branch"><a href="re-flow.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="re-flow.db.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></a></li><li class="depth-2 branch"><a href="re-flow.events.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>events</span></div></a></li><li class="depth-2 branch current"><a href="re-flow.flow.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>flow</span></div></a></li><li class="depth-2 branch"><a href="re-flow.interceptors.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interceptors</span></div></a></li><li class="depth-2 branch"><a href="re-flow.spec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>spec</span></div></a></li><li class="depth-2 branch"><a href="re-flow.subs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>subs</span></div></a></li><li class="depth-2"><a href="re-flow.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="re-flow.flow.html#var-add-state"><div class="inner"><span>add-state</span></div></a></li><li class="depth-1"><a href="re-flow.flow.html#var-add-transition"><div class="inner"><span>add-transition</span></div></a></li><li class="depth-1"><a href="re-flow.flow.html#var-current-state"><div class="inner"><span>current-state</span></div></a></li><li class="depth-1"><a href="re-flow.flow.html#var-db"><div class="inner"><span>db</span></div></a></li><li class="depth-1"><a href="re-flow.flow.html#var-flow"><div class="inner"><span>flow</span></div></a></li><li class="depth-1"><a href="re-flow.flow.html#var-set-db"><div class="inner"><span>set-db</span></div></a></li><li class="depth-1"><a href="re-flow.flow.html#var-start"><div class="inner"><span>start</span></div></a></li><li class="depth-1"><a href="re-flow.flow.html#var-start-state"><div class="inner"><span>start-state</span></div></a></li><li class="depth-1"><a href="re-flow.flow.html#var-transition"><div class="inner"><span>transition</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">re-flow.flow</h1><div class="doc"><div class="markdown"><p>Functions for defining, querying, and executing flows.</p>
<p>A flow is a data structure that describes a potential progression of state, accretion of auxiliary data, and a marker that describes which state is current. In practice, a flow is very similar to a finite state machine.</p>
<p>The potential progression of state is expressed as a collection of individual states, each of which must contain a name and may optionally contain a map that describes to which state the flow should progress given some value.</p>
<p>The following is a simple state definition.</p>
<pre><code class="clojure">{:name       :my-state
 :transition {:value-a                    :my-next-state
              :value-b                    :some-other-state
              :re-flow.transition/default :yet-another-state}
</code></pre>
<p>The <code>:re-flow.transition/default</code> is matched when a transition value is provided that does not match any of the other transition values.</p>
<p>Note that states are not limited to these keys; they may contain any other data necessary for processing. Refer to the documentation for <a href="re-flow.core.html">re-flow.core</a> for additional information. We highly encourage you to ensure that your state definitions comprise only simple values (i.e., those that are serializable to JSON or transit). The flow API is designed to be runnable on both server and client so that flows may passed between the two.</p>
<p>In addition to defining the states, you must also provide the name of the starting state. This is accomplished by either calling <a href="re-flow.flow.html#var-start-state">start-state</a> and providing the name of the starting state, or by providing an option map with the starting state name associated with the <code>:start</code> key.</p>
<p>Once a flow has been started (e.g., by calling <a href="re-flow.flow.html#var-start">start</a>), you may query a flow for its current state by calling <a href="re-flow.flow.html#var-current-state">current-state</a>.</p>
<p>Finally, a flow may maintain a database that accretes data when a transition occurs. The database is maintained independently of the state, and it persists over the lifetime of the flow. Use <a href="re-flow.flow.html#var-db">db</a> to get the current value of a flowâ€™s database. The initial database may be set by using a value associated with the <code>:db</code> key in the option map passed to <a href="re-flow.flow.html#var-flow">flow</a>.</p>
<p>Following is a short example that demonstrates constructing a somewhat complex flow using the flow-descriptor approach. The flow that we wish to construct is depicted below. Capital letters represent state names, and lowercase keywords represent transition values between states. <code>*</code> indicates a default transition.</p>
<pre><code>      start
        |
        V
        A &lt;------|
       / \       |
  :b  /   \ :c   | :a
     /     \     |
    V       V    |
    B       C ---|
     \  :d/ ^
   *  \  /  |
       \/   | :c
        V   |
        D---|
       /^
      / |
      ---
       *
</code></pre>
<p>The code to express this flow is as follows. Note that the result of this call can be used to start a flow using the re-frame events provided in the client part of re-flow.</p>
<pre><code class="clojure">(re-flow.flow/flow
  [{:name :A
    :transition {:b :B
                 :c :C}}
   {:name :B
    :transition {:re-flow.transition/default :D}}

   {:name :C
    :transition {:a :A
                 :d :D}

   {:name :D
    :transition {:c :C
                 :re-flow.transition/default :D}]

  {:start :A})
</code></pre></div></div><div class="public anchor" id="var-add-state"><h3>add-state</h3><div class="usage"><code>(add-state flow state)</code></div><div class="doc"><div class="markdown"><p>Adds a state to the flow.</p>
<p>If a state with the same name already exists in the flow, it will be completely replaced by the new state.</p></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljc/re_flow/flow.cljc#L154">view source</a></div></div><div class="public anchor" id="var-add-transition"><h3>add-transition</h3><div class="usage"><code>(add-transition flow from to)</code><code>(add-transition flow from value to)</code></div><div class="doc"><div class="markdown"><p>Adds a transition between states whose names are identifed by from and to.</p>
<p>If no transition value is provided, it is set as the default transition. If a transition exists between from and any other node under the same transition value, that transition will be replaced.</p></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljc/re_flow/flow.cljc#L174">view source</a></div></div><div class="public anchor" id="var-current-state"><h3>current-state</h3><div class="usage"><code>(current-state flow)</code></div><div class="doc"><div class="markdown"><p>Gets the current state of the flow.</p></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljc/re_flow/flow.cljc#L204">view source</a></div></div><div class="public anchor" id="var-db"><h3>db</h3><div class="usage"><code>(db flow)</code></div><div class="doc"><div class="markdown"><p>Gets the database of the flow.</p></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljc/re_flow/flow.cljc#L214">view source</a></div></div><div class="public anchor" id="var-flow"><h3>flow</h3><div class="usage"><code>(flow)</code><code>(flow states)</code><code>(flow states opts)</code></div><div class="doc"><div class="markdown"><p>Creates a flow using a collection of states and flow options if specified.</p></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljc/re_flow/flow.cljc#L138">view source</a></div></div><div class="public anchor" id="var-set-db"><h3>set-db</h3><div class="usage"><code>(set-db flow db)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljc/re_flow/flow.cljc#L224">view source</a></div></div><div class="public anchor" id="var-start"><h3>start</h3><div class="usage"><code>(start flow)</code><code>(start flow start)</code></div><div class="doc"><div class="markdown"><p>Transitions the flow into the starting state.</p>
<p>If provided, initial-db will be merged with the db in the flow definition. Returns nil if no starting state is specified within the flow.</p></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljc/re_flow/flow.cljc#L244">view source</a></div></div><div class="public anchor" id="var-start-state"><h3>start-state</h3><div class="usage"><code>(start-state flow state-name)</code></div><div class="doc"><div class="markdown"><p>Updates the flow to indicate which state to use as the starting state.</p></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljc/re_flow/flow.cljc#L194">view source</a></div></div><div class="public anchor" id="var-transition"><h3>transition</h3><div class="usage"><code>(transition flow)</code><code>(transition flow transition-key)</code></div><div class="doc"><div class="markdown"><p>Transitions to the next state in the flow.</p>
<p>The next state is determined by the specified transition key. If the key matches a value in the current stateâ€™s transition table, then the corresponding state is set as the next state. However, if no value matches then this function looks for a transition named :re-flow.transition/default. Returns nil if no suitable transition is found.</p></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljc/re_flow/flow.cljc#L263">view source</a></div></div></div></body></html>