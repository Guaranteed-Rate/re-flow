<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>re-flow.interceptors documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Re-flow</span> <span class="project-version">0.7.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>re-flow</span></div></div></li><li class="depth-2 branch"><a href="re-flow.coeffects.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>coeffects</span></div></a></li><li class="depth-2 branch"><a href="re-flow.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="re-flow.db.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></a></li><li class="depth-2 branch"><a href="re-flow.events.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>events</span></div></a></li><li class="depth-2 branch"><a href="re-flow.flow.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>flow</span></div></a></li><li class="depth-2 branch current"><a href="re-flow.interceptors.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interceptors</span></div></a></li><li class="depth-2 branch"><a href="re-flow.spec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>spec</span></div></a></li><li class="depth-2 branch"><a href="re-flow.subs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>subs</span></div></a></li><li class="depth-2"><a href="re-flow.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="re-flow.interceptors.html#var-conform-transition-data"><div class="inner"><span>conform-transition-data</span></div></a></li><li class="depth-1"><a href="re-flow.interceptors.html#var-default-interceptors"><div class="inner"><span>default-interceptors</span></div></a></li><li class="depth-1"><a href="re-flow.interceptors.html#var-flow-name"><div class="inner"><span>flow-name</span></div></a></li><li class="depth-1"><a href="re-flow.interceptors.html#var-state-change-dispatch"><div class="inner"><span>state-change-dispatch</span></div></a></li><li class="depth-1"><a href="re-flow.interceptors.html#var-update-flow-db"><div class="inner"><span>update-flow-db</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">re-flow.interceptors</h1><div class="doc"><div class="markdown"><p>Functions to build and use interceptors within re-flow.</p>
<p>Interceptors are the primary method for extending the behavior of re-flow. When a start or transition event are being handled, the event handlers will load any transition interceptors from the app-db and inject them into the re-frame interceptor queue. There are several interceptors that are used by default (see <a href="re-flow.interceptors.html#var-default-interceptors">default-interceptors</a>), but you can provide your own list by dispatching a <code>:re-flow.events/set-transition-interceptors</code> event or by calling <a href="re-flow.events.html#var-set-transition-interceptors">re-flow.events/set-transition-interceptors</a>.</p>
<p>The only guaranteed provided by re-flow is that the name of the flow will be in the context under the key <code>:re-flow.transition/flow-name</code>. You may also call <a href="re-flow.interceptors.html#var-flow-name">flow-name</a> to get this value.</p>
<p>It is important to pay attention to the order of the interceptors since some of them (e.g., <a href="re-flow.interceptors.html#var-conform-transition-data">conform-transition-data</a>) may change the transition data in such a way that data may be lost.</p></div></div><div class="public anchor" id="var-conform-transition-data"><h3>conform-transition-data</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Transition interceptor that generates a transition value.</p>
<p>This interceptor intends to take the transition data and conform it with a state’s <code>:transition-spec</code>, if provided.</p>
<p>The spec is provided a map that contains a key <code>:db</code> with the current flow db and a key <code>:td</code> with the transition data. The spec should conform this value into a value that can be used to transition. The event is updated to provide this value.</p>
<p><a href="re-flow.spec.html#var-td-spec">re-flow.spec/td-spec</a> is designed to make building simple transition specs.</p>
<p>Since this interceptor transforms the transition event directly, you should ensure that you have stored or otherwise processed the transition data with other interceptors before executing this interceptor.</p></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljs/re_flow/interceptors.cljs#L134">view source</a></div></div><div class="public anchor" id="var-default-interceptors"><h3>default-interceptors</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>A default list of interceptors.</p>
<p>This list includes the following in listed order:</p>
<ul>
  <li><a href="re-flow.interceptors.html#var-state-change-dispatch">state-change-dispatch</a></li>
  <li><a href="re-flow.interceptors.html#var-update-flow-db">update-flow-db</a></li>
  <li><a href="re-flow.interceptors.html#var-conform-transition-data">conform-transition-data</a></li>
</ul></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljs/re_flow/interceptors.cljs#L172">view source</a></div></div><div class="public anchor" id="var-flow-name"><h3>flow-name</h3><div class="usage"><code>(flow-name context)</code></div><div class="doc"><div class="markdown"><p>Gets the name of the flow that is the target of the current event.</p></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljs/re_flow/interceptors.cljs#L29">view source</a></div></div><div class="public anchor" id="var-state-change-dispatch"><h3>state-change-dispatch</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Transition interceptor that dispatches a specified event on state change.</p>
<p>This interceptor examines the new state after transition. If the new state is different from the old state, it pulls the <code>:dispatch</code> value from the state if one is provided and prepares the event to be dispatched.</p>
<p>The <code>:dispatch</code> value may be a keyword or vector, where the vector is a partial event. The dispatch value with the new state as the final parameter.</p>
<p>It appends the event to <code>:dispatch-n</code> in the effect map in order to avoid overwriting changes caused by other interceptors.</p></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljs/re_flow/interceptors.cljs#L62">view source</a></div></div><div class="public anchor" id="var-update-flow-db"><h3>update-flow-db</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Transition interceptor that updates the flow db.</p>
<p>This interceptor updates the flow db by determining by conforming the transition value with a state’s db-spec, if provided. If the value does not conform, an error is dispatched and the transition is abandoned.</p>
<p>The spec is provided a map that contains a key <code>:db</code> with the current flow db and a key <code>:td</code> with the transition data. The spec should conform this value into either a single value or a map. If the return value is a simple value, then it will be treated as if in a map associated with a key or either the state’s <code>:key</code> or <code>:name</code>.</p>
<p>The resulting map will be merged into the db after the transition is complete.</p></div></div><div class="src-link"><a href="https://github.com/Guaranteed-Rate/re-flow/blob/v0.7.0/src/cljs/re_flow/interceptors.cljs#L88">view source</a></div></div></div></body></html>